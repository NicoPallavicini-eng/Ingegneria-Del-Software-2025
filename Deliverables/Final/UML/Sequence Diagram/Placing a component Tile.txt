sequenceDiagram
    participant user as User
    participant rmi as RMIClient
    participant server as Server
    participant sc as ServerController
    participant game as Game
    participant gs as GameState
    participant eh as EventHandler

    alt try while(!input.equals("/disconnect"))
        rmi->>+user: Enter command: 
        user->>+rmi: input = scanner.nextLine()
        rmi->>+server: server.handleUserInput(this,input)
        server->>+sc: serverController.handleUserInput(virtualClient,input)
        alt 
            alt try
                sc->>+sc: executeCommand(command, firstParameters, secondParameters, client)
                alt switch (command) case "placetile"
                    alt player != null
                        alt secondParameters.isEmpty()
                            alt firstParameters.size() == 2
                                alt
                                    alt try
                                        sc->>+sc: PlaceTileEvent(player, rowInt-5, columnInt-4)
                                        sc->>+game: game.getGameState().handleEvent(event, game)
                                        game->>+gs: handleEvent(event, game)
                                        gs->>+game: playerOptional = game.getListOfPlayers().stream().filter(p -> p.getNickname().equals(event.nickname())).findAny()
                                        alt
                                            gs->>+eh: EventHandler.handleEvent(event)
                                            alt
                                                eh-->>+game: ship.setTileOnFloorPlan(event.row(), event.col(), ship.getTileInHand())
                                                eh-->>+game: ship.setLastPlacedTile(ship.getTileInHand())
                                                eh-->>+game: ship.setTileInHand(null)
                                            else ship.getTileOnFloorPlan(event.row(), event.col())
                                                eh->>+eh: throw new IllegalEventException("Can't place Tile because spot is occupied")
                                            else ship.getTileInHand() == null
                                                eh->>+eh: throw new IllegalEventException("You need to place a Tile in hand")
                                            end
                                        else finishedBuildingPlayers.contains(event.player()) || timeIsUp
                                            gs-->>-gs: throw new IllegalEventException("You can no longer place any tiles")
                                        end
                                    else IllegalEventException e
                                        rmi-->>+user: e.getMessage()
                                    end
                                else (rowInt < 5 || rowInt > 9 || columnInt < 4 || columnInt > 10) || !checkPosition
                                    sc-->>+user: Row or column not valid. It must be between 5 and 9 for rows and between 4 and 10 for columns
                                end
                            else
                                alt try
                                else IllegalEventException e
                                    rmi-->>+user: e.getMessage()
                                end
                            end
                        end
                    else
                        sc-->>+user: You are not connected to the game!
                    end
                else default
                    sc-->>-rmi: client.invalidCommand("Invalid command. Type /help for a list of available commands.")
                end
            else NumberFormatException
                sc-->>-rmi: client.invalidCommand("Invalid command")
            end
        else input == null || !input.startsWith("/")
            sc->>+rmi: client.invalidCommand("Invalid command")
        end
    else RemoteException e
        rmi-->>-rmi: throw new RuntimeException(e)
    else IllegalEventException
        rmi-->>-user: "Error: "+ e.getMessage()
    end